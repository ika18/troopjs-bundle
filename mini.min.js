/**
 * troopjs-bundle - 2.0.0-81-g639f791
 * @license MIT http://troopjs.mit-license.org/ Â© Mikael Karon mailto:mikael@karon.se
 */
define("troopjs-utils/unique",[],function(){var e="length";return function(t){var r,n,o,i,a=this,u=a[e];if(t)e:for(n=i=0;u>n;n++){for(r=a[n],o=0;n>o;o++)if(t.call(a,r,[o])===!0)continue e;a[i++]=r}else e:for(n=i=0;u>n;n++){for(r=a[n],o=0;n>o;o++)if(r===a[o])continue e;a[i++]=r}return a[e]=i}}),define("poly/lib/_base",["require","exports","module"],function(e,t){var r;r={}.toString,t.isFunction=function(e){return"function"==typeof e},t.isString=function(e){return"[object String]"==r.call(e)},t.toString=function(e){return r.apply(e)},t.createCaster=function(e,t){return function(r){if(null==r)throw new TypeError(t+" method called on null or undefined");return e(r)}}}),define("poly/object",["./lib/_base"],function(e){"use strict";function t(e){return function(){throw Error("poly/object: "+e+" is not safely supported.")}}function r(t){var r=g[t];return e.isFunction(r)?r(c):r in c}function n(){}function o(e,t){return e.hasOwnProperty(t)}function i(e){var t=[];for(var r in e)o(e,r)&&t.push(r);return t}function a(e){var r;r="function"==typeof e?e:function(){return e};for(var n in d)Object[n]=r(n)?t(n):d[n]}function u(e){if("object"!=typeof e)throw new TypeError("Object.getPrototypeOf called on non-object")}var c,s,f,l,p,h,g,d,y,v,m,b="hasOwnProperty";return c=Object,s=c.prototype,f="object"==typeof{}.__proto__,l=function(){for(var e in{valueOf:1})return!1;return!0}(),p=f?function(e){return u(e),e.__proto__}:function(e){return u(e),v&&e[v](y)?e[v](y.proto):e.constructor?e.constructor.prototype:s},h=l?function(e){return function(t){for(var r,n=i(t),a=0;r=e[a++];)o(t,r)&&n.push(r);return n}}(["constructor",b,"isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"]):i,g={"object-create":"create","object-freeze":"freeze","object-isfrozen":"isFrozen","object-seal":"seal","object-issealed":"isSealed","object-getprototypeof":"getPrototypeOf","object-keys":"keys","object-getownpropertynames":"getOwnPropertyNames","object-defineproperty":function(e){try{return"defineProperty"in e&&"sentinel"in Object.defineProperty({},"sentinel",{})}catch(t){}},"object-defineproperties":"defineProperties","object-isextensible":"isExtensible","object-preventextensions":"preventExtensions","object-getownpropertydescriptor":function(e){try{return"getOwnPropertyDescriptor"in e&&0===Object.getOwnPropertyDescriptor({sentinel:0}).value}catch(t){}}},d={},y={proto:{}},v=!r("object-getprototypeof")&&!f&&l&&b,v&&function(e){s[b]=function(t){return t==v?!1:e.call(this,t)}}(s[b]),r("object-create")||(Object.create=d.create=function(e,t){var r;if("object"!=typeof e)throw new TypeError("prototype is not of type Object or Null.");if(n.prototype=e,r=new n,n.prototype=null,v){var o=r[v];r[v]=function(t){return t==y?!0:t==y.proto?e:o.call(this,t)}}return arguments.length>1&&Object.defineProperties(r,t),r}),r("object-freeze")||(Object.freeze=d.freeze=function(e){return e}),r("object-isfrozen")||(Object.isFrozen=d.isFrozen=function(){return!1}),r("object-seal")||(Object.seal=d.seal=function(e){return e}),r("object-issealed")||(Object.isSealed=d.isSealed=function(){return!1}),r("object-getprototypeof")||(Object.getPrototypeOf=d.getPrototypeOf=p),r("object-keys")||(Object.keys=h),r("object-getownpropertynames")||(Object.getOwnPropertyNames=d.getOwnPropertyNames=function(e){return h(e)}),r("object-defineproperty")&&r("object-defineproperties")||(Object.defineProperty=d.defineProperty=function(e,t,r){return e[t]=r&&r.value,e}),r("object-defineproperties")&&r("object-create")||(Object.defineProperties=d.defineProperties=function(e,t){var r,n;for(r=h(t);n=r.pop();)Object.defineProperty(e,n,t[n]);return e}),r("object-isextensible")||(Object.isExtensible=d.isExtensible=function(e){var t="_poly_";try{for(;t in e;)t+="_";return e[t]=1,o(e,t)}catch(r){return!1}finally{try{delete e[t]}catch(r){}}}),r("object-preventextensions")||(Object.preventExtensions=d.preventExtensions=function(e){return e}),r("object-getownpropertydescriptor")||(Object.getOwnPropertyDescriptor=d.getOwnPropertyDescriptor=function(e,t){return o(e,t)?{value:e[t],enumerable:!0,configurable:!0,writable:!0}:m}),{failIfShimmed:a}}),define("troopjs-core/component/factory",["troopjs-utils/unique","poly/object"],function(e){function t(){return r.apply(this,arguments)()}function r(){var e=[this];return p.apply(e,arguments),c.apply(null,e)}function n(e,t){var r={};r[w]={value:e},r[j]={value:t},Object.defineProperties(this,r)}function o(e){return new n(e,o[j])}function i(e){return new n(e,i[j])}function a(e){return new n(e,a[j])}function u(){var e=this,t=e[s];return y in t?t[y]:g.call(e)}function c(){function o(){var e,t=this instanceof o?this:Object.create(D),r=arguments;for(Object.defineProperty(t,S,{value:o}),e=0;l>e;e++)r=C[e].apply(t,r)||r;return t}var i,a,c,l,g,y,w,x,O,E,T,_,F,H,$=[],L=arguments,M=L[v],C=[],D={},X={},U={};for(x=0;M>x;x++){if(c=L[x],typeof c===d){if(P in c?p.apply(C,c[P]):p.call(C,c),A in c&&h.apply($,c[A]),c===c[s][S])continue;c=c[s]}for(y=Object.getOwnPropertyNames(c),O=0,w=y[v];w>O;O++)g=y[O],(_=I.exec(g))?(i={},i[q]=E=_[1],i[N]=_[2],i[z]=T=_[3],i[R]=E+"/"+T,i[k]=c[g],h.call($,i)):(H=Object.getOwnPropertyDescriptor(c,g),F=H[k],X[g]=F instanceof n?F[j](X[g]||{enumerable:!0,configurable:!0,writable:!0}):H)}for(Object.defineProperties(D,X),l=e.call(C),a=e.call($),x=0;a>x;x++)i=$[x],E=i[q],T=i[z],g=i[R],E=E in $?$[E]:$[E]=[],T=T in E?E[T]:E[T]=$[g]=[],E[E[v]]=T[T[v]]=i;return U[s]={value:D},U[P]={value:C},U[A]={value:$},U[f]={value:u},U[m]={value:r},U[b]={value:t},Object.defineProperties(o,U),o}var s="prototype",f="toString",l=Array[s],p=l.push,h=l.unshift,g=Object[s][f],d="function",y="displayName",v="length",m="extend",b="create",j="decorate",w="decorated",x="before",O="after",E="around",S="constructor",P="constructors",A="specials",q="group",k="value",N="features",z="type",R="name",I=/^(\w+)(?::([^\/]+))?\/(.+)/,T=function(){},_={};return o[j]=function(e){var t=this[w],r=e[k];return e[k]=r?function(){var e=this,n=arguments;return r.apply(e,n=t.apply(e,n)||n)}:t,e},i[j]=function(e){var t=e[k],r=this[w];return e[k]=t?function(){var e=this,n=arguments;return r.apply(e,n=t.apply(e,n)||n)}:r,e},a[j]=function(e){return e[k]=this[w](e[k]||T),e},_[b]={value:function(){return c.apply(null,arguments)()}},_[x]={value:o},_[O]={value:i},_[E]={value:a},Object.defineProperties(c,_),c}),function(e){"use strict";e("when/when",[],function(){function e(e,t,n,o){return r(e).then(t,n,o)}function t(e){this.then=e}function r(e){return i(function(t){t(e)})}function n(t){return e(t,c)}function o(){function e(e,i,a){t.resolve=t.resolver.resolve=function(t){return o?r(t):(o=!0,e(t),n)},t.reject=t.resolver.reject=function(e){return o?r(c(e)):(o=!0,i(e),n)},t.notify=t.resolver.notify=function(e){return a(e),e}}var t,n,o;return t={promise:I,resolve:I,reject:I,notify:I,resolver:{resolve:I,reject:I,notify:I}},t.promise=n=i(e),t}function i(e){function r(e,t,r){return i(function(n,o,i){p?p.push(function(a){a.then(e,t,r).then(n,o,i)}):m(function(){l.then(e,t,r).then(n,o,i)})})}function n(e){p&&(l=a(e),f(p,l),p=I)}function o(e){n(c(e))}function u(e){p&&f(p,s(e))}var l,p=[];try{e(n,o,u)}catch(h){o(h)}return new t(r)}function a(e){return e instanceof t?e:e!==Object(e)?u(e):i(function(t,r,n){m(function(){try{var o=e.then;"function"==typeof o?P(o,e,t,r,n):t(u(e))}catch(i){r(i)}})})}function u(e){var r=new t(function(t){try{return"function"==typeof t?a(t(e)):r}catch(n){return c(n)}});return r}function c(e){var r=new t(function(t,n){try{return"function"==typeof n?a(n(e)):r}catch(o){return c(o)}});return r}function s(e){var r=new t(function(t,n,o){try{return"function"==typeof o?s(o(e)):r}catch(i){return s(i)}});return r}function f(e,t){m(function(){for(var r,n=0;r=e[n++];)r(t)})}function l(e){return e&&"function"==typeof e.then}function p(t,r,n,o,a){return w(2,arguments),e(t,function(t){function u(n,o,i){function a(e){h(e)}function u(e){p(e)}var c,s,f,l,p,h,g,d;if(g=t.length>>>0,c=Math.max(0,Math.min(r,g)),f=[],s=g-c+1,l=[],c)for(h=function(e){l.push(e),--s||(p=h=x,o(l))},p=function(e){f.push(e),--c||(p=h=x,n(f))},d=0;g>d;++d)d in t&&e(t[d],u,a,i);else n(f)}return i(u).then(n,o,a)})}function h(e,t,r,n){function o(e){return t?t(e[0]):e[0]}return p(e,1,o,r,n)}function g(e,t,r,n){return w(1,arguments),y(e,O).then(t,r,n)}function d(){return y(arguments,O)}function y(t,r){return e(t,function(t){function n(n,o,i){var a,u,c,s,f;if(c=u=t.length>>>0,a=[],c)for(s=function(t,u){e(t,r).then(function(e){a[u]=e,--c||n(a)},o,i)},f=0;u>f;f++)f in t?s(t[f],f):--c;else n(a)}return i(n)})}function v(t,r){var n=P(S,arguments,1);return e(t,function(t){var o;return o=t.length,n[0]=function(t,n,i){return e(t,function(t){return e(n,function(e){return r(t,e,i,o)})})},E.apply(t,n)})}function m(e){1===q.push(e)&&b()}function b(){A(j)}function j(){for(var e,t=0;e=q[t++];)e();q=[]}function w(e,t){for(var r,n=t.length;n>e;)if(r=t[--n],null!=r&&"function"!=typeof r)throw Error("arg "+n+" must be a function")}function x(){}function O(e){return e}e.defer=o,e.resolve=r,e.reject=n,e.join=d,e.all=g,e.map=y,e.reduce=v,e.any=h,e.some=p,e.isPromise=l,t.prototype={otherwise:function(e){return this.then(I,e)},ensure:function(e){function t(){return r(e())}var n=this;return this.then(t,t).yield(n)},yield:function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return g(t,function(t){return e.apply(I,t)})})},always:function(e,t){return this.then(e,e,t)}};var E,S,P,A,q,k,N,z,R,I;return q=[],k=setTimeout,A="function"==typeof setImmediate?"undefined"==typeof window?setImmediate:setImmediate.bind(window):"object"==typeof process&&process.nextTick?process.nextTick:function(e){k(e,0)},N=Function.prototype,z=N.call,P=N.bind?z.bind(z):function(e,t){return e.apply(t,S.call(arguments,2))},R=[],S=R.slice,E=R.reduce||function(e){var t,r,n,o,i;if(i=0,t=Object(this),o=t.length>>>0,r=arguments,1>=r.length)for(;;){if(i in t){n=t[i++];break}if(++i>=o)throw new TypeError}else n=r[1];for(;o>i;++i)i in t&&(n=e(n,t[i],i,t));return n},e})}("function"==typeof define&&define.amd?define:function(e){module.exports=e()}),define("when",["when/when"],function(e){return e}),define("troopjs-utils/merge",["poly/object"],function(){var e="length",t=Array.prototype,r=t.concat,n=Object.prototype,o=n.toString,i=o.call(n),a=o.call(t);return function u(t){var n,c,s,f,l,p,h,g,d,y,v=this;for(s=0,l=arguments[e];l>s;s++)for(t=arguments[s],c=Object.keys(t),f=0,p=c[e];p>f;f++)n=c[f],h=t[n],g=v[n],n in v?(d=o.call(h),y=o.call(g),y===i&&d===i?u.call(g,h):v[n]=y===a&&d===a?r.call(g,h):h):v[n]=h;return v}}),define("troopjs-core/component/base",["./factory","when","troopjs-utils/merge"],function(e,t,r){var n=Array.prototype,o=n.push,i=n.slice,a="instanceCount",u="configuration",c="phase",s="value",f="sig",l=0;return e(function(){var e=this;e[a]=++l,e[u]={}},{instanceCount:l,displayName:"core/component/base",configure:function(){return r.apply(this[u],arguments)},signal:function(e){function r(e){return++h>-1&&(p[h]=e),(n=c[l++])?t(n[s].apply(o,a),r):t.resolve(p)}var n,o=this,a=i.call(arguments,1),u=o.constructor.specials,c=f in u&&u[f][e]||[],l=0,p=[],h=-2;return r(a)},start:function(){var e=this,t=e.signal,r=[e[c]="initialize"];return o.apply(r,arguments),t.apply(e,r).then(function(o){return r[0]=e[c]="start",t.apply(e,r).then(function(t){return e[c]="started",n.concat(o,t)})})},stop:function(){var e=this,t=e.signal,r=[e[c]="stop"];return o.apply(r,arguments),t.apply(e,r).then(function(o){return r[0]=e[c]="finalize",t.apply(e,r).then(function(t){return e[c]="finalized",n.concat(o,t)})})},toString:function(){var e=this;return e.displayName+"@"+e[a]}})}),define("troopjs-core/logger/console",["../component/base"],function(e){function t(){}var r=console;return e.create({displayName:"core/logger/console"},r?{log:r.log.bind(r),warn:r.warn.bind(r),debug:r.debug.bind(r),info:r.info.bind(r),error:r.error.bind(r)}:{log:t,warn:t,debug:t,info:t,error:t})}),define("poly/array",["./lib/_base"],function(e){"use strict";function t(t){return"[object String]"==e.toString(t)?t.split(""):c(t)}function r(e){return"[object Array]"==h.call(e)}function n(t){var r=u[t];return e.isFunction(p[r])}function o(){return 1}function i(e){return e}function a(r,n,o,i,a,u){var c,s,f,p;if(c=t(r),s=c.length>>>0,a===l&&(a=0),u||(u=1),p=0>u?-1:s,!e.isFunction(n))throw new TypeError(n+" is not a function");if(a==p)return!1;if(p>=a^u>0)throw new TypeError("Invalid length or starting index");for(f=a;f!=p;f+=u)if(f in c&&!o(n.call(i,c[f],f,c),f,c[f]))return!1;return!0}var u,c,s,f,l,p=Array.prototype,h={}.toString;u={"array-foreach":"forEach","array-every":"every","array-some":"some","array-map":"map","array-filter":"filter","array-reduce":"reduce","array-reduceright":"reduceRight","array-indexof":"indexOf","array-lastindexof":"lastIndexOf"},c=e.createCaster(Object,"Array"),n("array-foreach")||(p.forEach=function(e){a(this,e,o,arguments[1])}),n("array-every")||(p.every=function(e){return a(this,e,i,arguments[1])}),n("array-some")||(p.some=function(e){return a(this,e,function(e){return!e},arguments[1])}),n("array-map")||(p.map=function(e){var t,r;return t=this,r=Array(t.length),a(t,e,function(e,t){return r[t]=e,1},arguments[1]),r}),n("array-filter")||(p.filter=function(e){var t,r;return t=this,r=[],a(t,e,function(e,t,n){return e&&r.push(n),1},arguments[1]),r}),n("array-reduce")&&n("array-reduceright")||(s=function s(e,r,n,u){var c,s,f;if(s=f=r>0?-1:t(this).length>>>0,u)c=n;else if(a(this,i,function(e,t){c=e,f=t},null,s+r,r),f==s)throw new TypeError;return a(this,function(t,r,n){c=e(c,t,r,n)},o,null,f+r,r),c},n("array-reduce")||(p.reduce=function(e){return s.call(this,e,1,arguments[1],arguments.length>1)}),n("array-reduceright")||(p.reduceRight=function(e){return s.call(this,e,-1,arguments[1],arguments.length>1)})),n("array-indexof")&&n("array-lastindexof")||(f=function f(e,r,n,o){var u=t(e).length>>>0,c=-1;return n=isNaN(n)?o?0:u-1:Number(n),0>n&&(n=u+n-1),a(e,i,function(e,t){return e===r&&(c=t),-1==c},null,n,o?1:-1),c},n("array-indexof")||(p.indexOf=function(e){return f(this,e,arguments[1],!0)}),n("array-lastindexof")||(p.lastIndexOf=function(e){return f(this,e,arguments[1],!1)})),Array.isArray||(Array.isArray=r)}),define("troopjs-core/event/emitter",["../component/base","when","poly/array"],function(e,t){function r(e,r,n){n=n||[];var o=0,i=n[s],a=i-1,f=function(s){var l,p;if(!b(s))throw Error("Result from handler has to be of type array");for(a++>=i&&(n[a]=s);(p=e[o++])&&(l=p[u])&&v.test(l[d]););return p?(p[h]=r)===r&&t(p[c].apply(l,s),f):t.resolve(n)};return f}function n(e,r,n){n=n||{};var i,s=0,f=function(l){var p,g;if(l!==o){if(!b(l))throw Error("Result from handler has to be of type array");n[a]=i=l}for(;(g=e[s++])&&(p=g[u])&&v.test(p[d]););return g?(g[h]=r)===r&&t(g[c].apply(p,i),f):t.resolve(i)};return f}var o,i=null,a="memory",u="context",c="callback",s="length",f="head",l="tail",p="next",h="handled",g="handlers",d="phase",y=/^(\w+)(?::(pipeline|sequence))/,v=/^(?:initi|fin)alized?$/,m=Array.prototype.slice,b=Array.isArray,j=Object.prototype.toString,w=j.call(Function.prototype);return e.extend(function(){this[g]={}},{displayName:"core/event/emitter",on:function(e,t,r){var n,i,a,s=this,d=arguments,y=s[g],v=2;if((r=d[v++])===o)throw Error("no callback provided");if(j.call(r)!==w)throw Error(j.call(r)+" is not a function");if(e in y){y=y[e],n={},n[c]=r,n[u]=t,a=l in y?y[l][p]=n:y[f]=n;for(;(r=d[v++])!==o;){if(j.call(r)!==w)throw Error(j.call(r)+" is not a function");a=a[p]=n={},n[c]=r,n[u]=t}y[l]=a}else{for(i=a=n={},n[c]=r,n[u]=t;(r=d[v++])!==o;){if(j.call(r)!==w)throw Error(j.call(r)+" is not a function");a=a[p]=n={},n[c]=r,n[u]=t}y=y[e]={},y[f]=i,y[l]=a,y[h]=0}return s},off:function(e,t){var r,n,o,i,a,h=this,d=arguments,y=d[s],v=h[g];if(!(e in v))return h;if(v=v[e],!(f in v))return h;r=v[f];do{if(!t||!r[u]||r[u]===t){for(a=!1,i=2;y>i;i++)if(r[c]===d[i]){a=!0;break}if(a)continue}n?o=o[p]=r:n=o=r}while(r=r[p]);return n&&o?(v[f]=n,v[l]=o,delete o[p]):(delete v[f],delete v[l]),h},emit:function(e){var o,u,c,s,l,d=this,v=m.call(arguments,1),b=d[g];if((s=y.exec(e))!==i&&(e=s[1],l=s[2]),e in b){if(b=b[e],f in b){u=[],c=0,o=b[f];do u[c++]=o;while(o=o[p]);return"sequence"===l?r(u,++b[h])(v):n(u,++b[h],b)(v)}}else b[e]=b={},b[h]=0;return b[a]=v,t.resolve(v)},reemit:function(e,o,l){var d,v,m,b,j,w,x,O,E=this,S=arguments,P=S[s],A=E[g];if((j=y.exec(e))!==i&&(e=j[1],w=j[2]),e in A&&(A=A[e],a in A)){if(!(f in A))return t.resolve(A[a]);m=[],b=0,d=A[f],v=A[h];do if(!l||!d[u]||d[u]===l){for(O=!1,x=3;P>x;x++)if(d[c]===S[x]){O=!0;break}(!O||d[h]!==v||o)&&(m[b++]=d)}while(d=d[p]);return"sequence"===w?r(m,v)(A[a]):n(m,v)(A[a])}return t.resolve()}})}),define("troopjs-core/pubsub/hub",["../event/emitter"],function(e){var t=e.prototype;return e.create({displayName:"core/pubsub/hub",subscribe:t.on,unsubscribe:t.off,publish:t.emit,republish:t.reemit})}),define("troopjs-core/logger/pubsub",["../component/base","../pubsub/hub"],function(e,t){var r=Array.prototype.push,n=t.publish;return e.create({displayName:"core/logger/pubsub",log:function(){var e=["logger/log"];r.apply(e,arguments),n.apply(t,e)},warn:function(){var e=["logger/warn"];r.apply(e,arguments),n.apply(t,e)},debug:function(){var e=["logger/debug"];r.apply(e,arguments),n.apply(t,e)},info:function(){var e=["logger/info"];r.apply(e,arguments),n.apply(t,e)},error:function(){var e=["logger/error"];r.apply(e,arguments),n.apply(t,e)}})}),define("troopjs-core/component/gadget",["../event/emitter","when","../pubsub/hub"],function(e,t,r){var n=Array.prototype,o=n.slice,i=n.push,a=r.publish,u=r.republish,c=r.subscribe,s=r.unsubscribe,f="length",l="features",p="type",h="value",g="subscriptions",d=e.prototype,y=d.on,v=d.off,m=d.reemit;return e.extend(function(){this[g]=[]},{displayName:"core/component/gadget","sig/initialize":function(){var e,t,n,o,i,a,u=this,s=u[g],d=u.constructor.specials.hub;for(n=0,o=d?d[f]:0;o>n;n++)t=d[n],e=s[n]={},e[p]=i=t[p],e[l]=t[l],e[h]=a=t[h],c.call(r,i,u,a)},"sig/start":function(){var e,n,o,i=this,a=arguments,c=i[g],s=[],d=0;for(n=0,o=c[f];o>n;n++)e=c[n],"memory"===e[l]&&(s[d++]=u.call(r,e[p],!1,i,e[h]));return t.all(s,function(){return a})},"sig/finalize":function(){var e,t,n,o=this,i=o[g];for(t=0,n=i[f];n>t;t++)e=i[t],s.call(r,e[p],o,e[h])},reemit:function(e,t){var r=this,n=[e,t,r];return i.apply(n,o.call(arguments,2)),m.apply(r,n)},on:function(e){var t=this,r=[e,t];return i.apply(r,o.call(arguments,1)),y.apply(t,r)},off:function(e){var t=this,r=[e,t];return i.apply(r,o.call(arguments,1)),v.apply(t,r)},publish:function(){return a.apply(r,arguments)},republish:function(e,t){var n=this,a=[e,t,n];return i.apply(a,o.call(arguments,2)),u.apply(r,a)},subscribe:function(e){var t=this,n=[e,t];return i.apply(n,o.call(arguments,1)),c.apply(r,n),t},unsubscribe:function(e){var t=this,n=[e,t];return i.apply(n,o.call(arguments,1)),s.apply(r,n),t}})}),define("troopjs-core/component/service",["./gadget"],function(e){return e.extend({displayName:"core/component/service","sig/initialize":function(){var e=this;return e.publish("registry/add",e)},"sig/finalize":function(){var e=this;return e.publish("registry/remove",e)}})}),define("troopjs-core/logger/service",["../component/service","troopjs-utils/merge","when"],function(e,t,r){function n(e,t){var n=this,o=n.signal,i=[e],a=n[p],u=0;c.apply(i,t);var s=function(){var e;return(e=a[u++])?r(o.apply(e,i),s):r.resolve(t)};return s()}function o(e,r){var n={cat:e,time:(new Date).getTime()};return s.call(r)===f?t.call(n,r):n.msg=r,n}function i(e){var t,r,n=this,o=n[p];for(t=0,r=o[l];r>t;t++)o[t].append(e)}var a=Array.prototype,u=a.slice,c=a.push,s=String.prototype.toString,f="[object Object]",l="length",p="appenders";return e.extend(function(){this[p]=u.call(arguments)},{displayName:"core/logger/service","sig/initialize":function(){return n.call(this,"initialize",arguments)},"sig/start":function(){return n.call(this,"start",arguments)},"sig/stop":function(){return n.call(this,"stop",arguments)},"sig/finalize":function(){return n.call(this,"finalize",arguments)},"hub/logger/log":function(e){i.call(this,o("log",e))},"hub/logger/warn":function(e){i.call(this,o("warn",e))},"hub/logger/debug":function(e){i.call(this,o("debug",e))},"hub/logger/info":function(e){i.call(this,o("info",e))},"hub/logger/error":function(e){i.call(this,o("error",e))}})}),define("troopjs-browser/ajax/service",["troopjs-core/component/service","jquery","troopjs-utils/merge","when"],function(e,t,r,n){var o=Array.prototype.slice;return e.extend({displayName:"browser/ajax/service","hub/ajax":function(e){var i=t.ajax(r.call({headers:{"x-request-id":(new Date).getTime()}},e));return n(i,function(){return o.call(arguments)})}})}),define("troopjs-utils/getargs",[],function(){var e=Array.prototype.push,t=String.prototype.substring,r=/^(?:false|true)$/i,n=/^true$/i,o=/^\d+$/;return function(){var i,a,u,c,s,f,l=this,p=[],h=!1;for(a=u=c=0,i=l.length;i>c;c++)switch(s=l.charAt(c)){case'"':case"'":h===s?(h=!1,e.call(p,t.call(l,a,u))):h=s,a=u=c+1;break;case",":if(h){u=c+1;break}a!==u&&(f=t.call(l,a,u),r.test(f)?f=n.test(f):o.test(f)&&(f=+f),e.call(p,f)),a=u=c+1;break;case" ":case"	":if(h){u=c+1;break}a===u&&(a=u=c+1);break;default:u=c+1}return a!==u&&(f=t.call(l,a,u),r.test(f)?f=n.test(f):o.test(f)&&(f=+f),e.call(p,f)),p}}),define("troopjs-utils/filter",[],function(){var e="length";return function(t){var r,n,o,i=this,a=i[e];for(n=o=0;a>n;n++)r=i[n],t.call(i,r,n)!==!1&&(i[o++]=r);return i[e]=o}}),define("troopjs-jquery/destroy",["jquery"],function(e){var t="destroy";e.event.special[t]={noBubble:!0,trigger:function(){return!1},remove:function(t){var r=this;t&&t.handler.call(r,e.Event({type:t.type,data:t.data,namespace:t.namespace,target:r}))}}}),define("poly/string",["./lib/_base"],function(e){"use strict";function t(t){var r=i[t];return e.isFunction(c[r])}function r(){return!1}function n(e,t){return e.replace(t,"")}function o(){a("string-trim")||(c.trim=function(){return n(n(u(this),f),s)}),a("string-trimleft")||(c.trimLeft=function(){return n(u(this),f)}),a("string-trimright")||(c.trimRight=function(){return n(u(this),s)})}var i,a,u,c=String.prototype;i={"string-trim":"trim","string-trimleft":"trimLeft","string-trimright":"trimRight"},a=t,u=e.createCaster(String,"String");var s,f;return s=/\s+$/,f=/^\s+/,o(),{setWhitespaceChars:function(e){s=RegExp(e+"$"),f=RegExp("^"+e),a=r,o()}}}),define("troopjs-jquery/weave",["require","jquery","when","troopjs-utils/getargs","troopjs-utils/filter","./destroy","poly/array","poly/string"],function(e,t,r,n,o){function i(){t(this).unweave()}function a(e){return t(e).attr(x)!==c}function u(e){return t(e).attr(O)!==c}var c,s=Array.prototype,f=s.map,l=s.push,p=t.fn,h=t.expr,g=h.createPseudo,d="widgets",y="weave",v="unweave",m="woven",b="destroy",j="length",w="data-",x=w+y,O=w+m,E=w+v,S="["+x+"]",P="["+O+"]",A=/[\s,]+/;h[":"][y]=g?g(function(e){return e===c?a:(e=RegExp(n.call(e).map(function(e){return"^"+e}).join("|"),"m"),function(r){var n=t(r).attr(x);return n!==c&&e.test(n.replace(A,"\n"))})}):function(e,r,o){var i=t(e).attr(x);return i===c?!1:o===c?!0:RegExp(n.call(o[3]).map(function(e){return"^"+e}).join("|"),"m").test(i.replace(A,"\n"))},h[":"][m]=g?g(function(e){return e===c?u:(e=RegExp(n.call(e).map(function(e){return"^"+e}).join("|"),"m"),function(r){var n=t(r).attr(O);return n!==c&&e.test(n.replace(A,"\n"))})}):function(e,r,o){var i=t(e).attr(O);return i===c?!1:o===c?!0:RegExp(n.call(o[3]).map(function(e){return"^"+e}).join("|"),"m").test(i.replace(A,"\n"))},p[y]=function(){var o=t(this),a=arguments,u=[],s=0;return o.filter(S).filter(function(){var e=t._data(this,"events"),r=e&&t.grep(e[b]||!1,function(e){return e.handler===i}).length>0;return!r}).on(b,i).end().each(function(o,i){var f,p,h,g,v,b=t(i),w=b.data(),E=w[d]||(w[d]=[]),S=E[j],P=[],A=0,q=b.attr(x),k=/[\s,]*([\w_\-\/\.]+)(?:\(([^\)]+)\))?/g;for(b.removeAttr(x);null!==(f=k.exec(q));){for(p=[b,f[1]],p[y]=f[0].trim(),f[2]&&l.apply(p,n.call(f[2])),h=2,g=p[j];g>h;h++)v=p[h],p[h]=v in w?w[v]:v;P[A++]=p}P.forEach(function(t,n){var o=r.defer(),i=o.resolver,u=E[S++]=P[n]=o.promise;u[y]=t[y],e([t[1]],function(e){var r;try{r=e.apply(e,t),u[m]=""+r,i.resolve(r.start.apply(r,a).yield(r))}catch(n){i.reject(n)}},i.reject)}),w[m]=u[s++]=r.all(P,function(e){var t=b.attr(O);return t=t===c?[]:[t],l.apply(t,e.map(function(e){return""+e})),0!==t[j]?b.attr(O,t.join(" ")):b.removeAttr(O),b.triggerHandler(y,e),e})}),r.all(u)},p[v]=function(){var e=t(this),n=arguments,i=[],a=0;return e.filter(P).each(function(e,u){var s,f,p,h=t(u),g=h.data(),b=g[d]||(g[d]=[]),w=[],S=0,P=h.attr(E);if(h.removeAttr(E),P)p=RegExp(P.split(A).map(function(e){return"^"+e}).join("|"),"m"),o.call(b,function(e){var t=p.test(e[m]);return t&&(w[S++]=e),!t}),r.all(b,function(e){return 0!==e[j]?h.attr(O,e.join(" ")):h.removeAttr(O),e});else{for(s=0,f=b[j];f>s;s++)w[S++]=b[s];b[j]=0,h.removeAttr(O)}w.forEach(function(e,t){w[t]=r(e,function(t){var r=t.stop.apply(t,n).yield(t);return r[y]=e[y],r})}),i[a++]=r.all(w,function(e){var t=h.attr(x);return t=t===c?[]:[t],l.apply(t,w.map(function(e){return e[y]})),0!==t[j]?h.attr(x,t.join(" ")):h.removeAttr(x),h.triggerHandler(v,e),e})}),r.all(i)},p[m]=function(){var e,n=[],o=0;return arguments[j]>0?(e=RegExp(f.call(arguments,function(e){return"^"+e}).join("|"),"m"),t(this).each(function(i,a){var u=(t.data(a,d)||[]).filter(function(t){return e.test(t[m])});n[o++]=r.all(u)})):t(this).each(function(e,i){n[o++]=r.all(t.data(i,d))}),r.all(n)}}),define("troopjs-browser/component/widget",["troopjs-core/component/gadget","jquery","troopjs-jquery/weave"],function(e,t){function r(e,t){return function(){return t.apply(e,arguments)}}function n(e){function t(t){var r=this,n=a.call(arguments,1);return e.call(r[f],typeof t===u?t.apply(r,n):t).find(p).weave()}return t}var o,i=Array.prototype,a=i.slice,u="function",c=t.fn.weave,s=t.fn.unweave,f="$element",l="$handlers",p="[data-weave]",h="[data-woven]",g="length",d="features",y="type",v="value",m="proxy",b="guid";return e.extend(function(e,t){var r=this;if(e===o)throw Error("No $element provided");r[f]=e,r[l]=[],t!==o&&(r.displayName=t)},{displayName:"browser/component/widget","sig/initialize":function(){var e,t,n,o,i,a,u,c,s=this,p=s[f],h=s[l],j=s.constructor.specials.dom;for(u=0,c=j?j[g]:0;c>u;u++)t=j[u],e=h[u]={},e[y]=n=t[y],e[d]=o=t[d],e[v]=i=t[v],e[m]=a=r(s,i),p.on(n,o,s,a),i[b]=a[b]},"sig/finalize":function(){var e,t,r,n=this,o=n[f],i=n[l];for(t=0,r=i[g];r>t;t++)e=i[t],o.off(e[y],e[d],e[m])},weave:function(){return c.apply(this[f].find(p),arguments)},unweave:function(){return s.apply(this[f].find(h).addBack(),arguments)},before:n(t.fn.before),after:n(t.fn.after),html:n(t.fn.html),text:n(t.fn.text),append:n(t.fn.append),prepend:n(t.fn.prepend)})}),define("troopjs-core/registry/service",["../component/service","poly/object","poly/array"],function(e){var t="services";return e.extend(function(){var e=this;e[t]={},e.add(e)},{displayName:"core/registry/service",add:function(e){this[t][""+e]=e},remove:function(e){delete this[t][""+e]},get:function(e){var r=RegExp(e),n=this[t];return Object.keys(n).filter(function(e){return r.test(e)}).map(function(e){return n[e]})},"hub/registry/add":function(e){return this.add(e)},"hub/registry/remove":function(e){return this.remove(e)},"hub/registry/get":function(e){return this.get(e)}})}),define("troopjs-browser/application/widget",["module","../component/widget","when","troopjs-core/registry/service","poly/array"],function(e,t,r,n){function o(e,t){var n=this,o=n.signal,i=[e],a=n[c].get(),s=0;u.apply(i,t);var f=function(){var e;return(e=a[s++])?r(o.apply(e,i),f):r.resolve(t)};return f()}var i=Array.prototype,a=i.slice,u=i.push,c="registry";return t.extend(function(){var e=this[c]=n();a.call(arguments,2).forEach(function(t){e.add(t)})},{displayName:"browser/application/widget","sig/initialize":function(){return o.call(this,"initialize",arguments)},"sig/start":function(){var e=this,t=e.weave,r=arguments;return o.call(e,"start",r).then(function(){return t.apply(e,r)})},"sig/stop":function(){var e=this,t=e.unweave,r=arguments;return t.apply(e,r).then(function(){return o.call(e,"stop",r)})},"sig/finalize":function(){return o.call(this,"finalize",arguments)}})}),define("troopjs-browser/route/uri",["troopjs-core/component/factory"],function(e){function t(e){var r,o,i={},a=n,u=/(?:&|^)([^&=]*)=?([^&]*)/g;if(i.toString=t.toString,c.call(e)===s)for(a in e)i[a]=e[a];else for(;(r=u.exec(e))!==n;)a=r[1],a in i?(o=i[a],c.call(o)===f?o[o.length]=r[2]:i[a]=[o,r[2]]):i[a]=r[2];return i}function r(e){var t=[];return t.toString=r.toString,a.apply(t,c.call(e)===f?e:u.call(e,"/")),t}var n=null,o=Array.prototype,i=Object.prototype,a=o.push,u=String.prototype.split,c=i.toString,s=c.call(i),f=c.call(o),l=c.call(Function.prototype),p=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:([^?#]*)(?:\?([^#]*))?(?:#(.*))?)/,h="protocol",g="authority",d="path",y="query",v="anchor",m=["source",h,g,"userInfo","user","password","host","port",d,y,v];t.toString=function(){var e,t,r,n,o=this,i=[],a=0;for(e in o)c.call(o[e])!==l&&(i[a++]=e);for(i.sort();a--;)if(e=i[a],t=o[e],c.call(t)===f){for(r=t.slice(0),r.sort(),n=r.length;n--;)t=r[n],r[n]=""===t?e:e+"="+t;i[a]=r.join("&")}else i[a]=""===t?e:e+"="+t;return i.join("&")},r.toString=function(){return this.join("/")};var b=e(function b(e){var o,i,a,u=this;if((i=p.exec(e))!==n)for(a=i.length;a--;)o=i[a],o&&(u[m[a]]=o);y in u&&(u[y]=t(u[y])),d in u&&(u[d]=r(u[d]))},{displayName:"browser/route/uri",toString:function(){var e,t,r=this,n=[h,"://",g,d,"?",y,"#",v];h in r||(n[0]=n[1]=""),g in r||(n[2]=""),d in r||(n[3]=""),y in r||(n[4]=n[5]=""),v in r||(n[6]=n[7]=""),e=n.length;for(;e--;)t=n[e],t in r&&(n[e]=r[t]);return n.join("")}});return b.Path=r,b.Query=t,b}),define("troopjs-jquery/hashchange",["jquery"],function(e){function t(e){var t=a.exec(e.location.href);return t&&t[1]?decodeURIComponent(t[1]):""}function r(e){var t,r=this;r.element=t=e.createElement("iframe"),t.src="about:blank",t.style.display="none"}var n="interval",o="hashchange",i="on"+o,a=/#(.*)$/,u=/\?/,c=0;r.prototype={getElement:function(){return this.element},getHash:function(){return this.element.contentWindow.frameHash},update:function(e){var t=this,r=t.element.contentWindow.document;t.getHash()!==e&&(r.open(),r.write("<html><head><title>' + document.title + '</title><script type='text/javascript'>var frameHash='"+e+"';</script></head><body>&nbsp;</body></html>"),r.close())}},e.event.special[o]={setup:function(){var a=this;if(i in a)return!1;if(!e.isWindow(a))throw Error("Unable to bind 'hashchange' to a non-window object");var s=e(a),f=t(a),l=a.location;s.data(n,a.setInterval(c?function(){var e=a.document,n="file:"===l.protocol,i=new r(e);return e.body.appendChild(i.getElement()),i.update(f),function(){var e,r=f,c=t(a),p=i.getHash();p!==f&&p!==c?(e=decodeURIComponent(p),f!==e&&(f=e,i.update(f),s.trigger(o,[e,r])),l.hash="#"+encodeURI(n?p.replace(u,"%3F"):p)):c!==f&&(e=decodeURIComponent(c),f!==e&&(f=e,s.trigger(o,[e,r])))}}():function(){var e,r=f,n=t(a);n!==f&&(e=decodeURIComponent(n),f!==e&&(f=e,s.trigger(o,[e,r])))},25))},teardown:function(){var t=this;return i in t?!1:(t.clearInterval(e.data(t,n)),void 0)}}}),define("troopjs-browser/route/widget",["../component/widget","./uri","troopjs-jquery/hashchange"],function(e,t){function r(e){var r=e.data,n=t(e.target.location.hash.replace(a,"")),o=""+n;o!==r[i]&&(r[i]=o,r.publish(r.displayName,n,e))}var n="$element",o="hashchange",i="route",a=/^#/;return e.extend({displayName:"browser/route/widget","sig/initialize":function(){var e=this;e[n].on(o,e,r)},"sig/start":function(){this[n].trigger(o)},"sig/finalize":function(){this[n].off(o,r)}})}),define("troopjs-requirejs/template",[],function(){function e(e){function t(e,t,r){return l[p]=t?'" +'+r+'+ "':'";'+r+'o += "',"<%"+(p++ +"")+"%>"}function s(e,t){return l[t]}function f(e,t){return c[t]||t}var l=[],p=0;return('function template(data) { var o = "'+e.replace(r,"").replace(n,t).replace(i,f).replace(o,s)+'"; return o; }').replace(a,u)
}var t={node:function(){var e=require.nodeRequire("fs");return function(t,r){var n=e.readFileSync(t,"utf8");0===n.indexOf("ï»¿")&&(n=n.substring(1)),r(n)}},browser:function(){var e,t,r,n=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"];if("undefined"!=typeof XMLHttpRequest)t=XMLHttpRequest;else{for(r=0;3>r;r++){e=n[r];try{new ActiveXObject(e),t=function(){return new ActiveXObject(e)};break}catch(o){}}if(!t)throw Error("XHR: XMLHttpRequest not available")}return function(e,r){var n=new t;n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&r(n.responseText)},n.send(null)}},rhino:function(){var e="utf-8",t=java.lang.System.getProperty("line.separator");return function(r,n){var o,i=new java.io.File(r),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(i),e)),u=new java.lang.StringBuffer,c="";try{for(o=a.readLine(),o&&o.length()&&65279===o.charAt(0)&&(o=o.substring(1)),u.append(o);null!==(o=a.readLine());)u.append(t),u.append(o);c=""+u+""}finally{a.close()}n(c)}},borked:function(){return function(){throw Error("Environment unsupported.")}}},r=/^[\n\t\r]+|[\n\t\r]+$/g,n=/<%(=)?([\S\s]*?)%>/g,o=/<%(\d+)%>/gm,i=/(["\n\t\r])/gm,a=/o \+= "";| \+ ""/gm,u="",c={'"':'\\"',"\n":"\\n","	":"\\t","\r":"\\r"},s={},f=t["undefined"!=typeof process&&process.versions&&process.versions.node?"node":"undefined"!=typeof window&&window.navigator&&window.document||"undefined"!=typeof importScripts?"browser":"undefined"!=typeof Packages?"rhino":"borked"]();return{load:function(t,r,n,o){var i=r.toUrl(t);f(i,function(a){try{a="define(function() { return "+e(a,t,i,o.template)+"; })"}catch(u){throw u.message="In "+i+", "+u.message,u}o.isBuild?s[t]=a:a+="\n//@ sourceURL='"+i+"'",n.fromText(t,a),r([t],function(e){n(e)})})},write:function(e,t,r){s.hasOwnProperty(t)&&r.asModule(e+"!"+t,s[t])}}}),define("troopjs-bundle/micro",["troopjs-core/logger/console","troopjs-core/logger/pubsub","troopjs-core/logger/service","troopjs-browser/ajax/service","troopjs-browser/application/widget","troopjs-browser/route/widget","troopjs-requirejs/template"]),define("troopjs-data/store/component",["troopjs-core/component/gadget","when"],function(e,t){var r,n="adapter",o="lock";return e.extend(function(e){if(e===r)throw Error("No adapter provided");this[n]=e},{displayName:"data/store/component",ready:function(e,r,n){var i=this;return i[o]=t(i[o],e,r,n)},set:function(e,r,o,i,a){return t(this[n].set(e,r),o,i,a)},get:function(e,r,o,i){return t(this[n].get(e),r,o,i)},remove:function(e,r,o,i){return t(this[n].remove(e),r,o,i)},clear:function(e,r,o){return t(this[n].clear(),e,r,o)}})}),define("troopjs-data/cache/component",["troopjs-core/component/base"],function(e){function t(e,u,c){var f,w,x,O,E,S,P,A,q,k,N,z,R=this,I=R[s];if(y in e?(w=e[y],w in R?f=R[w]:(f=R[w]=e,f[b]=c)):f=e,u===a)for(x=0,O=e[d];O>x;x++)z=e[x],u=z===o||z===r?r:z[g],f[x]=u===i||u===a&&0!==z[d]?t.call(R,z,u,c):z;else if(u===i)for(N in e)N===y||N===j&&f[j]===n||(z=e[N],u=z===o||z===r?r:z[g],f[N]=u===i||u===a&&0!==z[d]?t.call(R,z,u,c):z);e:if(w!==o){if(E=0|c+(f[v]>>>0),m in f){if(S=f[m],S===E)break e;S in I&&delete I[S][w]}if(f[m]=E,E in I)I[E][w]=f;else if((k=I[E]={})[h]=E,k[w]=f,I[l]!==r){for(A=P=I[l];(q=A[p])!==r&&E>q[h];A=q);A===P&&A[h]>E?(k[p]=A,I[l]=k):(k[p]=A[p],A[p]=k)}else I[l]=k}return f}var r,n=!1,o=null,i=Object,a=Array,u=1e3,c="interval",s="generations",f="age",l="head",p="next",h="expires",g="constructor",d="length",y="id",v="maxAge",m="expires",b="indexed",j="collapsed";return e.extend(function(e){var t=this;t[f]=e||60*u,t[s]={}},{displayName:"data/cache/component","sig/start":function(){var e=this,t=e[s];e[c]=c in e?e[c]:setInterval(function(){var n,o,i=0|(new Date).getTime()/u;if(o=t[l],o!==r){do{if(o[h]>i)break;for(n in o)n!==h&&n!==p&&n!==s&&delete e[n];delete t[o[h]]}while(o=o[p]);t[l]=o}},e[f])},"sig/stop":function(){var e=this;c in e&&(clearInterval(e[c]),delete e[c])},"sig/finalize":function(){var e,t=this;for(e in t)t[e][g]===i&&y in t[e]&&delete t[e]},put:function(e){var n=this,c=e===o||e===r?r:e[g];return c===i||c===a&&0!==e[d]?t.call(n,e,c,0|(new Date).getTime()/u):e}})}),define("troopjs-data/query/component",["troopjs-core/component/base"],function(e){var t,r=!0,n=!1,o=Object,i=Array,a="constructor",u="length",c="op",s="!",f=".",l=",",p="|",h="text",g="raw",d="resolved",y="id",v="expires",m="collapsed",b="_ast",j="_query",w=/("|')(.*?)\1/,x="$2",O=/!(.*[!,|.\s]+.*)/,E="!'$1'";return e.extend(function(e){var r=this;e!==t&&(r[j]=e)},{displayName:"data/query/component",parse:function(e){var r=this;delete r[b],e=r[j]=e||r[j]||"";var n,o,i,a,d,y,v=[];for(n=a=0,o=e[u];o>n;n++)switch(i=e.charAt(n)){case'"':case"'":d=d===i?t:i;break;case s:if(d!==t)break;y={},y[c]=i;break;case f:case l:if(d!==t)break;y!==t&&(y[g]=(y[h]=e.substring(a,n)).replace(w,x),v.push(y)),y={},y[c]=i,a=n+1;break;case p:case" ":case"	":case"\r":case"\n":if(d!==t)break;y!==t&&(y[g]=(y[h]=e.substring(a,n)).replace(w,x),v.push(y)),y=t,a=n+1}return y!==t&&(y[g]=(y[h]=e.substring(a,o)).replace(w,x),v.push(y)),r[b]=v,r},reduce:function(e){var p=this,j=0|(new Date).getTime()/1e3;b in p||p.parse();var w,x,S,P,A,q,k,N,z=p[b],R=[],I=n;for(w=0,P=z[u];P>w;w++)switch(A=z[w],A[c]){case s:k=A,q=A[g],q in e?(N=e[q],A[d]=N[m]!==r&&!(v in N)||N[v]>j):(N=t,A[d]=n);break;case f:if(q=A[g],N&&q in N)if(N=N[q],S=N[a],S===i){for(A[d]=r,x=N[u];x-->0;)if(S=N[x],S[a]===o&&y in S&&(S[m]===r||v in S)&&!(S[v]>j)){A[d]=n;break}}else S===o&&y in N?(A[c]=s,A[h]=(A[g]=N[y]).replace(O,E),A[d]=N[m]!==r&&!(v in N)||N[v]>j):A[d]=r;else N=t,A[d]=n;break;case l:q=k[g],N=e[q],A[c]=s,A[h]=k[h],A[g]=q,A[d]=k[d]}for(;P-->0;)switch(A=z[P],A[c]){case s:(I||A[d]!==r)&&R.unshift(A),I=n;break;case f:R.unshift(A),I=r}return p[b]=R,p},ast:function(){var e=this;return b in e||e.parse(),e[b]},rewrite:function(){var e=this;b in e||e.parse();var t,r,n,o=e[b],i="";for(r=0,t=o[u];t>r;r++)switch(n=o[r],n[c]){case s:i+=0===r?n[h]:p+n[h];break;case f:i+=f+n[h]}return i}})}),function(e){e("when/apply",[],function(){var e=Object.prototype.toString;return function(t){return function(r){if("[object Array]"!=e.call(r))throw Error("apply called with non-array arg");return t.apply(null,r)}}})}("function"==typeof define&&define.amd?define:function(e){module.exports=e(require)}),define("troopjs-data/query/service",["module","troopjs-core/component/service","./component","troopjs-utils/merge","when","when/apply"],function(e,t,r,n,o,i){var a,u=Array.prototype,c=u.slice,s=u.concat,f=u.push,l="length",p="batches",h="interval",g="cache",d="queries",y="resolved",v="configuration",m="raw",b="id",j="q",w=e.config();return t.extend(function(e){var t=this;if(e===a)throw Error("No cache provided");t[p]=[],t[g]=e,t.configure(w)},{displayName:"data/query/service","sig/start":function(){var e=this,t=e[g];e[h]=h in e?e[h]:setInterval(function(){function r(){var t,r=[];for(t=u[l];t--;)f.apply(r,u[t][j]);return e.publish("ajax",n.call({data:{q:r.join("|")}},e[v]))}function o(e){var r,n,o,i,a;for(t.put(e),i=u[l];i--;){for(r=u[i],n=r[d],o=r[b],a=n[l];a--;)a in o&&(n[a]=t[o[a]]);r.resolve(n)}}function a(){var e,t;for(t=u[l];t--;)e=u[t],e.reject(e[d])}var u=e[p];0!==u[l]&&(e[p]=[],r().then(i(o),a))},200)},"sig/stop":function(){var e=this;h in e&&(clearInterval(e[h]),delete e[h])},"hub/query":function(){var e,t,n,i,a,h,v=this,w=v[p],x=v[g],O=[],E=[],S=o.defer(),P=S.resolver;try{for(a=s.apply(u,c.call(arguments)),t=0,i=a[l];i>t;t++)for(h=r(a[t]),e=h.ast(),e[l]>0&&(E[t]=e[0][m]),e=h.reduce(x).ast(),n=e[l];n-->0;)if(!e[n][y]){f.call(O,h.rewrite());break}if(0===O[l]){for(t=0;i>t;t++)t in E&&(a[t]=x[E[t]]);P.resolve(a)}else P[d]=a,P[b]=E,P[j]=O,w.push(P)}catch(A){P.reject(A)}return S.promise}})}),define("troopjs-data/component/widget",["troopjs-browser/component/widget"],function(e){var t=Array.prototype.push;return e.extend({displayName:"data/component/widget",query:function(){var e=this,r=["query"];return t.apply(r,arguments),e.publish.apply(e,r)}})}),define("troopjs-bundle/mini",["./micro","troopjs-data/store/component","troopjs-data/cache/component","troopjs-data/query/service","troopjs-data/component/widget"]);