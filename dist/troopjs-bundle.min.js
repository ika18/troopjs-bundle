/*! troopjs-bundle - v1.0.2+ - 2012-08-01
* http://troopjs.com/
* Copyright (c) 2012 Mikael Karon <mikael@karon.se>; Licensed MIT
 */
(function(a){a("compose",[],function(){function a(){}function c(a){if(!a)throw new Error("Compose arguments must be functions or objects");return a}function d(a,b,d){var f,g=b.length;for(;d<g;d++){var h=b[d];if(typeof h=="function"){var i=h.prototype;for(var k in i){f=i[k];var l=i.hasOwnProperty(k);if(typeof f=="function"&&k in a&&f!==a[k]){var n=a[k];f==j?f=n:l||(e(f,k,m([].slice.call(b,0,d),!0))?f=n:e(n,k,m([h],!0))||console.error("Conflicted method "+k+", final composer must explicitly override with correct method."))}f&&f.install&&l&&!e(n,k,m([h],!0))?f.install.call(a,k):a[k]=f}}else for(var k in c(h)){var f=h[k];if(typeof f=="function"){if(f.install){f.install.call(a,k);continue}if(k in a&&f==j)continue}a[k]=f}}return a}function e(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[b]==a)return!0}}function f(a,b){function c(){if(b)return b.apply(this,arguments);throw new Error("Decorator not applied")}return c.install=a,c}function g(a){return function(b){return f(function c(d){var e=this[d];(b=this[d]=e?a(this,e,b):b).install=c},b)}}function j(){throw new Error("This method is required and no implementation has been provided")}function k(){var a=[this];return a.push.apply(a,arguments),l.apply(0,a)}function l(e){function h(){var b;this instanceof h?b=this:(a.prototype=g,b=new a);for(var c=0;c<j;c++){var d=i[c],e=d.apply(b,arguments);if(typeof e=="object")if(e instanceof h)b=e;else for(var f in e)e.hasOwnProperty(f)&&(b[f]=e[f])}return b}var f=arguments,g=f.length<2&&typeof f[0]!="function"?f[0]:d(b(c(e)),f,1);h._getBases=function(a){return a?n:i};var i=m(f),j=i.length;typeof f[f.length-1]=="object"&&(f[f.length-1]=g);var n=m(f,!0);return h.extend=k,l.secure||(g.constructor=h),h.prototype=g,h}function m(a,b){function d(a,e){f:for(var g=0;g<a.length;g++){var h=a[g],i=b&&typeof h=="function"?h.prototype:h;if(b||typeof h=="function"){var j=e&&h._getBases;if(j)d(j(b));else{for(var k=0;k<c.length;k++)if(i==c[k])continue f;c.push(i)}}}}var c=[];return d(a,!0),c}var b=Object.create?function(a){return Object.create(typeof a=="function"?a.prototype:a||Object.prototype)}:function(b){a.prototype=typeof b=="function"?b.prototype:b;var c=new a;return a.prototype=null,c};l._setMixin=function(a){d=a},l.Decorator=f,l.around=g(function(a,b,c){return c.call(a,b)}),l.before=g(function(a,b,c){return function(){var a=c.apply(this,arguments);if(a!==h)return b.apply(this,a||arguments)}});var h=l.stop={},i;return l.after=g(function(a,b,c){return function(){var a=b.apply(this,arguments),d=c.apply(this,arguments);return d===i?a:d}}),l.from=function(a,b){return b?(typeof a=="function"?a.prototype:a)[b]:f(function(c){if(!(this[c]=typeof a=="string"?this[a]:(typeof a=="function"?a.prototype:a)[b||c]))throw new Error("Source method "+b+" was not available to be renamed to "+c)})},l.create=function(a){var c=d(b(a),arguments,1),e=arguments.length;for(var f=0;f<e;f++){var g=arguments[f];typeof g=="function"&&(c=g.call(c)||c)}return c},l.required=j,l.apply=function(a,b){return a?d(a,b,0):k.apply.call(l,0,b)},l.call=function(a){return d(a,arguments,1)},l})})(typeof define!="undefined"?define:function(a,b){typeof module!="undefined"?module.exports=b():Compose=b()}),define("troopjs-core/component/base",["compose","config"],function a(a,b){var c=0;return a(function(){this.instanceCount=c++},{displayName:"core/component",config:b,toString:function(){var a=this;return a.displayName+"@"+a.instanceCount}})}),define("troopjs-core/util/deferred",["jquery"],function(a){return a.Deferred}),define("troopjs-core/util/unique",[],function(){return function a(a){var b=this,c=b.length,d=[],e,f,g,h;i:for(f=g=h=0;f<c;f++,g=0){e=b[f];while(g<h)if(a.call(b,e,d[g++])===!0)continue i;d[h++]=e}return d}}),define("troopjs-core/pubsub/topic",["../component/base","../util/unique"],function d(a,b){function e(a,b){return a.publisherInstanceCount===b.publisherInstanceCount}var c=Object.prototype.toString,d=c.call(Array.prototype);return a.extend(function(a,b,c){var d=this;d.topic=a,d.publisher=b,d.parent=c,d.publisherInstanceCount=b.instanceCount},{displayName:"core/pubsub/topic",toString:function(){return this.topic},trace:function h(){var a=this,f=a.constructor,g,h,i="",j,k,l;while(a){if(c.call(a)===d){k=b.call(a,e);for(j=0,l=k.length;j<l;j++)h=k[j],k[j]=h.constructor===f?h.trace():h.topic;i+=k.join(",");break}g=a.parent,i+=g?a.publisher+":":a.publisher,a=g}return i}})}),define("troopjs-core/pubsub/hub",["compose","../component/base","./topic"],function e(a,b,c){var d=Function,e="memory",f="context",g="callback",h="length",i="head",j="tail",k="next",l="handled",m={},n={},o=0;return a.create({displayName:"core/pubsub/hub",subscribe:function p(a){var b=this,c=arguments[h],o=arguments[1],p=arguments[2],q=arguments[3],r,s,t,u,v,w;if(o instanceof d)q=o,p=!1,o=m,r=1;else if(o===!0||o===!1)q=p,p=o,o=m,r=2;else if(p instanceof d)q=p,p=!1,r=2;else if(q instanceof d)r=3;else return b;if(a in n){s=n[a],t={callback:arguments[r++],context:o},w=j in s?s[j][k]=t:s[i]=t;while(r<c)w=w[k]={callback:arguments[r++],context:o};s[j]=w;if(p&&e in s){p=s[e],u=p[l];if(p[h]>0)while(t){if(t[l]===u){t=t[k];continue}t[l]=u,t[g].apply(t[f],p),t=t[k]}else while(t){if(t[l]===u){t=t[k];continue}t[l]=u,t[g].call(t[f]),t=t[k]}}}else{v=w={callback:arguments[r++],context:o};while(r<c)w=w[k]={callback:arguments[r++],context:o};n[a]={head:v,tail:w}}return b},unsubscribe:function q(a){var b=arguments[h],c=arguments[1],e=arguments[2],l,o,p,r,s=null;if(c instanceof d)e=c,c=m,l=1;else if(e instanceof d)l=2;else return self;q:{if(!(a in n))break q;o=n[a],r=o[i];while(l<b){e=arguments[l++],p=s=r;do{if(p[g]===e&&p[f]===c){if(p===r){r=s=p[k];continue}s[k]=p[k];continue}s=p}while(p=p[k])}r&&s?(o[i]=r,o[j]=s):(delete o[i],delete o[j])}return this},publish:function(a){var b,c,d=arguments[l]=o++;if(a in n){b=n[a],b[e]=arguments,c=b[i];if(arguments[h]>0)while(c){if(c[l]===d){c=c[k];continue}c[l]=d,c[g].apply(c[f],arguments),c=c[k]}else while(c){if(c[l]===d){c=c[k];continue}c[l]=d,c[g].call(c[f]),c=c[k]}}else arguments[h]>0&&(n[a]=b={},b[e]=arguments);return this}})}),define("troopjs-core/component/gadget",["compose","./base","../util/deferred","../pubsub/hub"],function f(a,b,c,d){var e=null,f=Function,g=/^hub(?::(\w+))?\/(.+)/,h=/^sig\/(.+)/,i=d.publish,j=d.subscribe,k=d.unsubscribe,l="memory",m="subscriptions";return b.extend(function n(){var b=this,d=b.constructor._getBases(!0),g,i,j,k,l,m,n={},o,p,q=null;for(k=d.length-1;k>=0;k--){g=d[k];r:for(q in g){j=g[q];if(!(j instanceof f))continue;p=h.exec(q);if(p!==e){o=p[1];if(o in n){i=n[o],l=m=i.length;while(l--)if(j===i[l])continue r;i[m]=j}else n[o]=[j]}}}a.call(b,{signal:function s(s,a){var b=this,d,e,f=a;if(s in n){d=n[s],e=d.length;while(--e)f=c(function(a){var c=d[e],g=f;a.done(function(){c.call(b,s,g)})});d[0].call(b,s,f)}else a&&a.resolve();return b}})},{displayName:"core/component/gadget","sig/initialize":function(a,b){var c=this,h=c[m]=[],i=e,j,k,n;for(i in c){j=c[i];if(j instanceof f)k=g.exec(i),k!==e&&(n=k[2],d.subscribe(n,c,k[1]===l,j),h[h.length]=[n,c,j],c[i]=e);else continue}return b&&b.resolve(),c},"sig/finalize":function(a,b){var c=this,e=c[m],f;while(f=e.shift())d.unsubscribe(f[0],f[1],f[2]);return b&&b.resolve(),c},publish:function(){var a=this;return i.apply(d,arguments),a},subscribe:function(){var a=this;return j.apply(d,arguments),a},unsubscribe:function(){var a=this;return k.apply(d,arguments),a},start:function(a){var b=this;return a=a||c(),c(function d(d){d.then(a.resolve,a.reject,a.notify),c(function(a){a.then(function(){b.signal("start",d)},d.reject,d.notify),b.signal("initialize",a)})}),b},stop:function(a){var b=this;return a=a||c(),c(function d(d){d.then(a.resolve,a.reject,a.notify),c(function(a){a.then(function(){b.signal("finalize",d)},d.reject,d.notify),b.signal("stop",a)})}),b}})}),define("troopjs-core/component/service",["./gadget"],function(a){return a.extend({displayName:"core/component/service"})}),define("troopjs-core/util/merge",[],function(){var a=Array,b=Object;return function c(d){var e=this,f=null,g,h,i,j;for(g=0,h=arguments.length;g<h;g++){d=arguments[g];for(f in d)i=d[f],j=i.constructor,f in e?j===a?e[f]=e[f].concat(i):j===b?c.call(e[f],i):e[f]=i:e[f]=i}return e}}),define("troopjs-core/remote/ajax",["../component/service","../pubsub/topic","jquery","../util/merge"],function(a,b,c,d){return a.extend({displayName:"core/remote/ajax","hub/ajax":function e(a,e,f){c.ajax(d.call({headers:{"x-request-id":(new Date).getTime(),"x-components":a instanceof b?a.trace():a}},e)).then(f.resolve,f.reject,f.notify)}})}),define("troopjs-core/util/uri",["compose"],function j(a){var b=null,c=Array.prototype,d=Object.prototype,e=c.push,f=String.prototype.split,g=d.toString,h=g.call(d),i=g.call(c),j=g.call(String.prototype),k=g.call(Function.prototype),l=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:([^?#]*)(?:\?([^#]*))?(?:#(.*))?)/,m="protocol",n="authority",o="path",p="query",q="anchor",r=["source",m,n,"userInfo","user","password","host","port",o,p,q],s=a.secure;a.secure=!0;var t=a(function(a){var c=this,d,e=b,f,j=/(?:&|^)([^&=]*)=?([^&]*)/g;switch(g.call(a)){case h:for(e in a)c[e]=a[e];break;default:while(d=j.exec(a))e=d[1],e in c?(f=c[e],g.call(f)===i?f[f.length]=d[2]:c[e]=[f,d[2]]):c[e]=d[2]}},{toString:function(){var a=this,c=b,d=b,e,f=[],h=0,j;for(c in a){if(g.call(a[c])===k)continue;f[h++]=c}f.sort();while(h--){c=f[h],d=a[c];if(g.call(d)===i){e=d.slice(0),e.sort(),j=e.length;while(j--)d=e[j],e[j]=d===""?c:c+"="+d;f[h]=e.join("&")}else f[h]=d===""?c:c+"="+d}return f.join("&")}}),u=a(c,function(a){var b=this;switch(g.call(a)){case i:e.apply(b,a);break;default:e.apply(b,f.call(a,"/"))}},{toString:function(){return this.join("/")}}),v=a(function(a){var b=this,c=l.exec(a),d=c.length,e;while(d--)e=c[d],e&&(b[r[d]]=e);p in b&&(b[p]=t(b[p])),o in b&&(b[o]=u(b[o]))},{toString:function(){var a=this,b=[m,"://",n,o,"?",p,"#",q],c,d;m in a||(b[0]=b[1]=""),n in a||(b[2]=""),o in a||(b[3]=""),p in a||(b[4]=b[5]=""),q in a||(b[6]=b[7]=""),c=b.length;while(c--)d=b[c],d in a&&(b[c]=a[d]);return b.join("")}});return a.secure=s,v.Path=u,v.Query=t,v}),define("troopjs-core/route/router",["../component/service","../util/uri"],function(a,b){function g(a){var c=a.data,d=b(a.target.location.hash.replace(f,"")),g=d.toString();g!==c[e]&&(c[e]=g,c.publish(e,d))}var c="hashchange",d="$element",e="route",f=/^#/;return a.extend(function(a){this[d]=a},{displayName:"core/route/router","sig/initialize":function(a,b){var e=this;return e[d].bind(c,e,g),b&&b.resolve(),e},"sig/start":function(a,b){var e=this;return e[d].trigger(c),b&&b.resolve(),e},"sig/finalize":function(a,b){var e=this;return e[d].unbind(c,g),b&&b.resolve(),e}})}),define("troopjs-core/store/base",["compose","../component/gadget"],function(a,b){var c="storage";return b.extend({storage:a.required,set:function d(a,b,d){this[c].setItem(a,JSON.stringify(b)),d&&d.resolve(b)},get:function(a,b){var d=JSON.parse(this[c].getItem(a));b&&b.resolve(d)},remove:function(a,b){this[c].removeItem(a),b&&b.resolve()},clear:function(a){this[c].clear(),a&&a.resolve()}})}),define("troopjs-core/store/local",["compose","./base"],function(a,b){return a.create(b,{displayName:"core/store/local",storage:window.localStorage})}),define("troopjs-core/store/session",["compose","./base"],function(a,b){return a.create(b,{displayName:"core/store/session",storage:window.sessionStorage})}),define("troopjs-core/dimensions/service",["../component/service"],function(a){function d(a,c,d){a.data.publish(b,c,d)}var b="dimensions",c="$element";return a.extend(function e(a,d){var e=this;e[c]=a,e[b]=d},{displayName:"core/dimensions/service","sig/initialize":function f(a,e){var f=this;f[c].bind(b+"."+f[b],f,d),e&&e.resolve()},"sig/start":function(a,d){var e=this;e[c].trigger("resize."+b),d&&d.resolve()},"sig/finalize":function(a,e){var f=this;f[c].unbind(b+"."+f[b],d),e&&e.resolve()}})}),define("troopjs-core/component/widget",["./gadget","jquery","../util/deferred"],function p(a,b,c){function v(a,b,c){return function(){return i.call(arguments,a),c.apply(b,arguments)}}function w(a){function b(){var b=this,d=b[p],g=arguments,i=h.call(g),j=g[g.length-1];if(j===f||!(j[s]instanceof e))j=c();return c(function(c){c.then(function(){d.trigger(o,arguments),j.resolve()},j.reject,j.notify),c.notify("beforeRender",b),a.call(d,i instanceof e?i.apply(b,g):i),c.notify("afterRender",b),d.find(t).weave(c)}),b}return b}var d=null,e=Function,f=undefined,g=Array.prototype,h=g.shift,i=g.unshift,j=b.fn.trigger,k=b.fn.one,l=b.fn.bind,m=b.fn.unbind,n=/^dom(?::(\w+))?\/([^\.]+(?:\.(.+))?)/,o="widget/refresh",p="$element",q="$proxies",r="one",s="then",t="[data-weave]",u="[data-woven]";return a.extend(function(a,b){var c=this;c[p]=a,b&&(c.displayName=b)},{displayName:"core/component/widget","sig/initialize":function(a,b){var c=this,f=c[p],g=c[q]=[],h=d,i,j,m;for(h in c){i=c[h];if(i instanceof e)j=n.exec(h),j!==d&&(m=j[2],i=v(m,c,i),(j[2]===r?k:l).call(f,m,c,i),g[g.length]=[m,i],c[h]=d);else continue}return b&&b.resolve(),c},"sig/finalize":function(a,b){var c=this,d=c[p],e=c[q],f;while(f=e.shift())d.unbind(f[0],f[1]);return b&&b.resolve(),c},weave:function(a){var b=this;return b[p].find(t).weave(a),b},unweave:function(a){var b=this;return b[p].find(u).andSelf().unweave(a),this},one:function(){var a=this;return k.apply(a[p],arguments),a},bind:function(){var a=this;return l.apply(a[p],arguments),a},unbind:function(){var a=this;return m.apply(a[p],arguments),a},trigger:function(){var a=this;return j.apply(a[p],arguments),a},before:w(b.fn.before),after:w(b.fn.after),html:w(b.fn.html),text:w(b.fn.text),append:w(b.fn.append),prepend:w(b.fn.prepend),empty:function(a){var b=this;return a=a||c(),c(function d(c){c.then(a.resolve,a.reject,a.notify);var d=b[p],e=d.contents().detach();d.trigger(o,b),setTimeout(function(){var a=e.get();e.remove(),c.resolve(a)},0)}),b}})}),define("troopjs-core/widget/placeholder",["../component/widget","../util/deferred"],function(a,b){function j(){var a=this,j=arguments,k=j.length,l=k>0&&j[k-1][i]instanceof c?d.call(j):b();return b(function m(c){var d,i,k,m;if(e in a)c.done(l.resolve).resolve(a[e]);else{c.then([function(b){a[g].attr(f,b),a[e]=b},l.resolve],l.reject,l.notify),k=a[h],m=[a[g],k];for(d=0,i=j.length;d<i;d++)m[d+2]=j[d];require([k],function(a){b(function d(b){var d=a.apply(a,m);b.then(function(){c.resolve(d)},c.reject,c.notify),d.start(b)})})}}),a}function k(a){var c=this;return a=a||b(),b(function d(b){var d;b.then(a.resolve,a.reject,a.notify),e in c?(d=c[e],delete c[e],c[g].removeAttr(f),d.stop(b)):b.resolve()}),c}var c=Function,d=Array.prototype.pop,e="holding",f="data-"+e,g="$element",h="target",i="then";return a.extend(function(a,b,c){this[h]=c},{displayName:"core/widget/placeholder",release:j,hold:k,finalize:k})}),define("troopjs-core/route/placeholder",["../widget/placeholder"],function(a){var b=null,c="route";return a.extend(function(a,b){this[c]=RegExp(a.data("route"))},{displayName:"core/route/placeholder","hub:memory/route":function e(a,d){var e=this,f=e[c].exec(d.path);f!==b?e.release.apply(e,f.slice(1)):e.hold()}})}),define("troopjs-core/widget/application",["../component/widget","../util/deferred"],function(a,b){return a.extend({displayName:"core/widget/application","sig/start":function(a,b){this.weave(b)},"sig/stop":function(a,b){this.unweave(b)}})}),define("troopjs-core/widget/sandbox",["../component/widget","jquery"],function(a,b){var c="$element",d="_"+c;return a.extend({"sig/initialize":function e(a,e){var f=this,g=f[d]=f[c],h=g.get(0).contentWindow;f[c]=b(h.ownerDocument||h.document),e&&e.resolve()},"sig/start":function(a,b){this.weave(b)},"sig/stop":function(a,b){this.unweave(b)}})}),define("troopjs-core/util/each",["jquery"],function(a){return a.each}),define("troopjs-core/util/grep",["jquery"],function(a){return a.grep}),define("troopjs-core/util/tr",[],function(){var a=typeof Number();return function b(b){var c=this,d=[],e,f=c.length,g;if(typeof f===a&&f===0||f>0&&0 in c&&f-1 in c)for(e=0;e<f;e++)d.push(b.call(c,c[e],e));else if(c)for(g in c)d.push(b.call(c,c[g],g));return d}}),define("troopjs-core/util/when",["jquery"],function(a){return a.when}),define("troopjs-jquery/action",["jquery"],function(a){function o(a,b){return a?a+"."+f:d}function p(b){var d=a(this),h=e.call(arguments,1),i=g in b?b[g].type:f,j=b[f];b.type=f+"/"+j+"."+i,d.trigger(b,h),b.result!==c&&(b.type=f+"/"+j+"!",d.trigger(b,h),b.result!==c&&(b.type=f+"."+i,d.trigger(b,h)))}function q(c){var e=a(c.target).closest("[data-action]");if(e.length===0)return;var g=e.data(),o=h.exec(g[f]);if(o===d)return;var p=o[1],q=o[2],r=o[3];if(q!==b&&!RegExp(q.split(j).join("|")).test(c.type))return;var s=r!==b?r.split(i):[];a.each(s,function(a,c){c in g?s[a]=g[c]:k.test(c)?s[a]=c.slice(1,-1):l.test(c)?s[a]=Number(c):m.test(c)?s[a]=n.test(c):s[a]=b}),e.trigger(a.Event(c,{type:f+"!",action:p}),s),c.stopPropagation()}var b=undefined,c=!1,d=null,e=Array.prototype.slice,f="action",g="originalEvent",h=/^([\w\d\s_\-\/]+)(?:\.([\w\.]+))?(?:\((.*)\))?$/,i=/\s*,\s*/,j=/\.+/,k=/^(["']).*\1$/,l=/^\d+$/,m=/^(?:false|true)$/i,n=/^true$/i;a.event.special[f]={setup:function(b,c,d){a(this).bind(f,b,p)},add:function(b){var c=a.map(b.namespace.split(j),o);c.length!==0&&a(this).bind(c.join(" "),q)},remove:function(b){var c=a.map(b.namespace.split(j),o);c.length!==0&&a(this).unbind(c.join(" "),q)},teardown:function(b){a(this).unbind(f,p)}},a.fn[f]=function(b){return a(this).trigger({type:f+"!",action:b},e.call(arguments,1))}}),define("troopjs-jquery/destroy",["jquery"],function(a){a.event.special.destroy={remove:function b(b){var c=this;b.handler.call(c,a.Event({type:b.type,data:b.data,namespace:b.namespace,target:c}))}}}),define("troopjs-jquery/resize",["jquery"],function(a){function h(b,f){var g=a.data(f),h=a(f),i=h.width(),j=h.height();(i!==g[d]||j!==g[e])&&h.trigger(c,[g[d]=i,g[e]=j])}function i(){f.each(h)}var b=null,c="resize",d="w",e="h",f=a([]),g=b;a.event.special[c]={setup:function(b,h,j){var k=this;if(a.isWindow(k))return!1;var l=a.data(k,c,{}),m=a(k);l[d]=m.width(),l[e]=m.height(),f=f.add(k),f.length===1&&(g=setInterval(i,100))},teardown:function(d){var e=this;if(a.isWindow(e))return!1;a.removeData(e,c),f=f.not(e),f.length===0&&g!==b&&clearInterval(g)}}}),define("troopjs-jquery/dimensions",["jquery"],function(a){function h(a,b){return b-a}function i(c){var h=a(this),i=h.width(),j=h.height();a.each(a.data(self,b),function k(a,c){var k=c[d],l=c[e],m,n,o;o=k.length,m=k[o-1];while(k[--o]<i)m=k[o];o=l.length,n=l[o-1];while(l[--o]<j)n=l[o];if(m!==c[f]||n!==c[g])c[f]=m,c[g]=n,h.trigger(b+"."+a,[m,n])})}var b="dimensions",c="resize."+b,d="w",e="h",f="_"+d,g="_"+e;a.event.special[b]={setup:function(d,e,f){a(this).bind(c,i).data(b,{})},add:function k(c){var f=this,g=c.namespace,i={},j=i[d]=[],k=i[e]=[],l=/(w|h)(\d+)/g,m;while(m=l.exec(g))i[m[1]].push(parseInt(m[2]));j.sort(h),k.sort(h),a.data(f,b)[g]=i},remove:function(c){delete a.data(this,b)[c.namespace]},teardown:function(d){a(this).removeData(b).unbind(c,i)}}}),define("troopjs-jquery/hashchange",["jquery"],function(a){function h(a){var b=e.exec(a.location.href);return b&&b[1]?decodeURIComponent(b[1]):""}function i(a){var b=this,c;b.element=c=a.createElement("iframe"),c.src="about:blank",c.style.display="none"}var b="interval",c="hashchange",d="on"+c,e=/#(.*)$/,f=/\?/,g=!1;i.prototype={getElement:function(){return this.element},getHash:function(){return this.element.contentWindow.frameHash},update:function(a){var b=this,c=b.element.contentWindow.document;if(b.getHash()===a)return;c.open(),c.write("<html><head><title>' + document.title + '</title><script type='text/javascript'>var frameHash='"+a+"';</script></head><body>&nbsp;</body></html>"),c.close()}},a.event.special[c]={setup:function(e,j,k){var l=this;if(d in l)return!1;if(!a.isWindow(l))throw new Error("Unable to bind 'hashchange' to a non-window object");var m=a(l),n=h(l),o=l.location;m.data(b,l.setInterval(g?function(){var a=l.document,b=o.protocol==="file:",d=new i(a);return a.body.appendChild(d.getElement()),d.update(n),function e(){var a=n,e,g=h(l),i=d.getHash();i!==n&&i!==g?(e=decodeURIComponent(i),n!==e&&(n=e,d.update(n),m.trigger(c,[e,a])),o.hash="#"+encodeURI(b?i.replace(f,"%3F"):i)):g!==n&&(e=decodeURIComponent(g),n!==e&&(n=e,m.trigger(c,[e,a])))}}():function(){var a=n,b,d=h(l);d!==n&&(b=decodeURIComponent(d),n!==b&&(n=b,m.trigger(c,[b,a])))},25))},teardown:function(c){var e=this;if(d in e)return!1;e.clearInterval(a.data(e,b))}}}),define("troopjs-jquery/weave",["jquery"],function(a){function A(){a(this).unweave()}var b=undefined,c=Array,d=Function,e=c.prototype,f=e.join,g=e.pop,h=a.when,i="then",j="weave",k="unweave",l="woven",m="weaving",n="pending",o="destroy",p="data-",q=p+j,r=p+l,s=p+m,t="["+q+"]",u="["+s+"],["+r+"]",v=/\s*,\s*/,w=/^(["']).*\1$/,x=/^\d+$/,y=/^(?:false|true)$/i,z=/^true$/i;a.fn[j]=function(){var c=[],e=0,k=a(this),m=arguments,p=m.length,u=p>0&&m[p-1][i]instanceof d?g.call(m):a.Deferred();return k.filter(t).each(function(d,g){a.Deferred(function i(d){var i=a(g),k=i.data(),p=k[j]=i.attr(q)||"",t=k[l]||(k[l]=[]),u=k[n]||(k[n]=[]);d.done(function(){i.removeAttr(s).attr(r,f.call(arguments," "))}),h.apply(a,u).then(function(){var f=/[\s,]*([\w_\-\/]+)(?:\(([^\)]+)\))?/g,g=e,j=0,l;u.push(d),i.removeAttr(q).attr(s,p).bind(o,A);while(l=f.exec(p))a.Deferred(function n(f){var g=j++,h,n,o,p;c[e++]=f,f.then(function(a){t[g]=a},d.reject,d.notify);var q=l[1],r=[i,q];for(h=0,o=m.length,n=r.length;h<o;h++,n++)r[n]=m[h];var s=l[2];if(s!==b){s=s.split(v);for(h=0,o=s.length,n=r.length;h<o;h++,n++)p=s[h],p in k?r[n]=k[p]:w.test(p)?r[n]=p.slice(1,-1):x.test(p)?r[n]=Number(p):y.test(p)?r[n]=z.test(p):r[n]=p}require([q],function(b){a.Deferred(function c(a){var c=b.apply(b,r);a.then(function(){f.resolve(c)},f.reject,f.notify),c.start(a)})})});h.apply(a,c.slice(g,e)).then(d.resolve,d.reject,d.notify)},d.reject,d.notify)})}),h.apply(a,c).then(u.resolve,u.reject,u.notify),k},a.fn[k]=function(b){var c=[],d=0,e=a(this);return b=b||a.Deferred(),e.filter(u).each(function(b,e){a.Deferred(function f(b){var f=a(e),g=f.data(),i=g[n]||(g[n]=[]),k=g[l]||[];b.done(function(){f.attr(q,g[j]).unbind(o,A),delete g[j]}),h.apply(a,i).done(function(){var e=d,j;i.push(b),delete g[l],f.removeAttr(r);while(j=k.shift())a.Deferred(function(b){c[d++]=b,a.Deferred(function(a){a.then(function(){b.resolve(j)},b.reject,b.notify),j.stop(a)})});h.apply(a,c.slice(e,d)).then(b.resolve,b.reject,b.notify)})})}),h.apply(a,c).then(b.resolve,b.reject,b.notify),e}}),define("troopjs-requirejs/template",[],function(){function i(a){function k(a,b,c){return i[j]=b?'" +'+c+'+ "':'";'+c+'o += "',"<%"+String(j++)+"%>"}function l(a,b){return i[b]}function m(a,b){return h[b]||b}var i=[],j=0;return('function template(data) { var o = "'+a.replace(b,"").replace(c,k).replace(e,m).replace(d,l)+'"; return o; }').replace(f,g)}var a={node:function(){var a=require.nodeRequire("fs");return function b(b,c){c(a.readFileSync(b,"utf8"))}},browser:function(){var a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],b,c,d;if(typeof XMLHttpRequest!="undefined")c=XMLHttpRequest;else e:{for(d=0;d<3;d++){b=a[d];try{c=ActiveXObject(b);break e}catch(f){}}throw new Error("XHR: XMLHttpRequest not available")}return function(a,b){var d=new c;d.open("GET",a,!0),d.onreadystatechange=function(a){d.readyState===4&&b(d.responseText)},d.send(null)}},rhino:function(){var a="utf-8",b=java.lang.System.getProperty("line.separator");return function c(c,d){var e=new java.io.File(c),f=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(e),a)),g=new java.lang.StringBuffer,h,i="";try{h=f.readLine(),h&&h.length()&&h.charAt(0)===65279&&(h=h.substring(1)),g.append(h);while((h=f.readLine())!==null)g.append(b),g.append(h);i=String(g.toString())}finally{f.close()}d(i)}},borked:function(){return function(){throw new Error("Environment unsupported.")}}},b=/^[\n\t\r]+|[\n\t\r]+$/g,c=/<%(=)?([\S\s]*?)%>/g,d=/<%(\d+)%>/gm,e=/(["\n\t\r])/gm,f=/o \+= "";| \+ ""/gm,g="",h={'"':'\\"',"\n":"\\n","\t":"\\t","\r":"\\r"},j={},k=a[typeof process!="undefined"&&process.versions&&!!process.versions.node?"node":typeof window!="undefined"&&window.navigator&&window.document||typeof importScripts!="undefined"?"browser":typeof Packages!="undefined"?"rhino":"borked"]();return{load:function(a,b,c,d){var e=b.toUrl(a);k(e,function(f){try{f="define(function() { return "+i(f,a,e,d.template)+"; })"}catch(g){throw g.message="In "+e+", "+g.message,g}d.isBuild?j[a]=f:f+="\n//@ sourceURL='"+e+"'",c.fromText(a,f),b([a],function(a){c(a)})})},write:function(a,b,c){j.hasOwnProperty(b)&&c.asModule(a+"!"+b,j[b])}}});